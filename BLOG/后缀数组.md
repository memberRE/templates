# 后缀数组

$sa[i]$表示排名为$i$的后缀首字母的位置

$rank[i]$表示以第$i$个字母开头的后缀的排名



## 构造

### 倍增算法

​	首先将每个后缀的第一个字母排序，得到$ sa[i]$表示以第$i$个字母开头的后缀的排名（此时只是第一个字母的排名，并非最终结果），然后对于每个$sa[i]$，将$sa[i+1]$与之拼接，用基数排序，得到每个后缀前2个字母的排序，接下来将$sa[i]$与$sa[i+2]$拼接进行排序，依次得到前4,8,16个字母的后缀排序。因为基数排序复杂度为$O(n)$所以总的时间复杂度为$O(nlogn)$

### DC3

​	不会

## 应用

### 最长公共前缀（LCP）

$LCP(i,j)$表示排名为**i**与**j**的后缀的LCP。

$height[i] = LCP(i,i-1)$

**性质**：

1. $LCP(i,k)=min\{LCP(i,j),LCP(j,k)\}$**对于任意1<=i<j<k<=n**
2. $LCP(i,j)=^{~~~~~min}_{i+1 \le k \le j}\{LCP(k-1,k)\}$
3. $h[i] >= h[i-1]-1$

关于第一个的证明，当lcp(i,j)==lcp(j,k)时，就要用到i<j<k这个条件了。

