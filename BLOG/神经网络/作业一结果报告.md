# 作业一结果报告

`18373665-陈源`

## 实验目的与实验环境

- 实验目的：通过对BP神经网络的训练，使其能够推断手写的数字。
- 实验环境：
  - Windows10 1903,pycharm 2019.3.5, cupy-cuda100
  - i5 8300H;GTX1060;16G内存

## 网络结构与设计方案

​		采用了四层网络结构，其中输入层有784个节点，隐藏层第一层有200个节点，隐藏层第二层有40个节点，输出层为10个节点。

​		学习率为`0.05`

​		采用cupy包，使用cuda进行矩阵计算。

## 所遇到的问题与解决途径

​		**问题：**在将神经网络改为使用cuda计算的时候，由于计算量不够大，出现了内存数据与显存数据交换的瓶颈。前馈计算和反向传播5000次仅比使用cpu计算快了一倍。但是将各种数据处理一起加入计算，整个训练过程与使用cpu相差无几。

​		**解决途径：**想办法减少内存与显存的数据交换，预处理的时候，先将所有训练数据存入显存，减少重复读取。修改了一些部分计算代码，由于默认的运算符会将数据保存到内存使用cpu进行计算，将加减乘除等运算符改为由cupy包所提供的函数，去掉了每次epoch计算准确率的部分。

​		**结果：**训练时间由`1300s`减少为`500s`

## 实验结果分析与讨论

​		![image-20201009214521771](C:\Users\Member\AppData\Roaming\Typora\typora-user-images\image-20201009214521771.png)

​		目前来看，经过多次调参，发现隐藏层不宜过大，过大将会使损失在$0.5与0.6$之间反复横跳，并且最终的准确率为0.91，于是降低学习率至0.05，并没有多少效果，最后减少了每层的节点数至200,40，准确率提升为0.95。但这依然不如参考代码的三层神经网络的0.97的准确率。

